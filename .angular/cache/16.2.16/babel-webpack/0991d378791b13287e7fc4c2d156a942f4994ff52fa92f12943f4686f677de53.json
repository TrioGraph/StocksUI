{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/request-metrics.service\";\nimport * as i2 from \"@angular/common\";\nfunction MetricsComponent_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\", 6);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 5, m_r1.time, \"medium\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(m_r1.method);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r1.url);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r1.status);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r1.durationMs);\n  }\n}\nlet MetricsComponent = /*#__PURE__*/(() => {\n  class MetricsComponent {\n    constructor(metricsSvc) {\n      this.metricsSvc = metricsSvc;\n      this.metrics = [];\n    }\n    ngOnInit() {\n      this.metrics = this.metricsSvc.getAll();\n    }\n    refresh() {\n      this.metrics = this.metricsSvc.getAll();\n    }\n    exportCSV() {\n      const rows = [['time', 'method', 'url', 'status', 'durationMs']];\n      for (const m of this.metrics) {\n        rows.push([new Date(m.time).toISOString(), m.method, m.url, String(m.status || ''), String(m.durationMs)]);\n      }\n      const csv = rows.map(r => r.map(v => '\"' + String(v).replace(/\"/g, '\"\"') + '\"').join(',')).join('\\n');\n      const blob = new Blob([csv], {\n        type: 'text/csv'\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'request-metrics.csv';\n      a.click();\n      URL.revokeObjectURL(url);\n    }\n    static {\n      this.ɵfac = function MetricsComponent_Factory(t) {\n        return new (t || MetricsComponent)(i0.ɵɵdirectiveInject(i1.RequestMetricsService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: MetricsComponent,\n        selectors: [[\"app-metrics\"]],\n        decls: 24,\n        vars: 1,\n        consts: [[1, \"card\"], [1, \"row\", 2, \"align-items\", \"center\", \"justify-content\", \"space-between\"], [1, \"btn\", \"secondary\", 3, \"click\"], [1, \"btn\", 3, \"click\"], [1, \"table\", 2, \"margin-top\", \"12px\"], [4, \"ngFor\", \"ngForOf\"], [2, \"max-width\", \"600px\", \"white-space\", \"nowrap\", \"overflow\", \"hidden\", \"text-overflow\", \"ellipsis\"]],\n        template: function MetricsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n            i0.ɵɵtext(3, \"Request Metrics\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\")(5, \"button\", 2);\n            i0.ɵɵlistener(\"click\", function MetricsComponent_Template_button_click_5_listener() {\n              return ctx.refresh();\n            });\n            i0.ɵɵtext(6, \"Refresh\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"button\", 3);\n            i0.ɵɵlistener(\"click\", function MetricsComponent_Template_button_click_7_listener() {\n              return ctx.exportCSV();\n            });\n            i0.ɵɵtext(8, \"Export CSV\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(9, \"table\", 4)(10, \"thead\")(11, \"tr\")(12, \"th\");\n            i0.ɵɵtext(13, \"Time\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"th\");\n            i0.ɵɵtext(15, \"Method\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(16, \"th\");\n            i0.ɵɵtext(17, \"URL\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"th\");\n            i0.ɵɵtext(19, \"Status\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"th\");\n            i0.ɵɵtext(21, \"Duration (ms)\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(22, \"tbody\");\n            i0.ɵɵtemplate(23, MetricsComponent_tr_23_Template, 12, 8, \"tr\", 5);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(23);\n            i0.ɵɵproperty(\"ngForOf\", ctx.metrics);\n          }\n        },\n        dependencies: [i2.NgForOf, i2.DatePipe],\n        styles: [\".card[_ngcontent-%COMP%]{padding:12px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:13px}\"]\n      });\n    }\n  }\n  return MetricsComponent;\n})();\nexport { MetricsComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}