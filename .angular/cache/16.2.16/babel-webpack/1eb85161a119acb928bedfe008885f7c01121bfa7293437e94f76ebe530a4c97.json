{"ast":null,"code":"import { throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../services/toast.service\";\nimport * as i3 from \"../services/auth.service\";\nlet ErrorInterceptor = /*#__PURE__*/(() => {\n  class ErrorInterceptor {\n    constructor(router, toast, auth) {\n      this.router = router;\n      this.toast = toast;\n      this.auth = auth;\n    }\n    intercept(req, next) {\n      return next.handle(req).pipe(catchError(err => {\n        if (!err) return throwError(() => err);\n        const message = err.error?.message || err.message || 'Server error';\n        // handle auth\n        if (err.status === 401) {\n          this.toast.show('Session expired, please login');\n          try {\n            this.auth.logout();\n          } catch (e) {}\n          this.router.navigate(['/login']);\n        } else if (err.status >= 500) {\n          this.toast.show('Server error. Try again later.');\n        } else {\n          // show non-intrusive message\n          this.toast.show(message);\n        }\n        return throwError(() => err);\n      }));\n    }\n    static {\n      this.ɵfac = function ErrorInterceptor_Factory(t) {\n        return new (t || ErrorInterceptor)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.ToastService), i0.ɵɵinject(i3.AuthService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: ErrorInterceptor,\n        factory: ErrorInterceptor.ɵfac\n      });\n    }\n  }\n  return ErrorInterceptor;\n})();\nexport { ErrorInterceptor };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}